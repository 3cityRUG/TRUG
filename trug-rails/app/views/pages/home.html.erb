<div class="landing-hero text-center">
  <h2 class="landing-lead">
    Trójmiejska Grupa
    <br>
    Użytkowników Ruby
  </h2>
  <a class="btn btn-brand" href="#next-meetup">Najbliższe spotkanie</a>
</div>

<div class="container text-center padding-bottom">
  <div class="grid grid-center">
    <div class="grid-item three-fifths compact-one">
      <h2 class="no-margin padding-top">Spotkania</h2>
      <p>Przeważnie odbywają się w przedostanią środę każdego miesiąca. Zapraszamy wszystkich zainteresowanych językiem programowania Ruby oraz technologiami pokrewnymi. Po prezentacjach rozmawiamy oraz gramy w gry planszowe.</p>
    </div>
  </div>
</div>

<div class="landing-community"></div>

<div class="container padding-vertical">
  <div class="grid">
    <div class="grid-item one-half compact-one text-left">
      <h2 id="next-meetup">Najbliższe spotkanie</h2>
      <table class="landing-schedule">
        <tr>
          <td class="nowrap">
            <p class="text-bold no-margin">Data</p>
          </td>
          <td>
            <% if @next_meetup %>
              <%= l(@next_meetup.date, format: '%Y-%m-%d') %> (<%= l(@next_meetup.date, format: '%A') %>)
            <% else %>
              Brak zaplanowanych spotkań
            <% end %>
          </td>
        </tr>
        <tr>
          <td class="nowrap">
            <p class="text-bold no-margin">Godzina</p>
          </td>
          <td>18:00</td>
        </tr>
        <tr>
          <td class="nowrap">
            <p class="text-bold no-margin">Miejsce</p>
          </td>
          <td>Hackerspace, al. Wojska Polskiego 41, Gdańsk</td>
        </tr>
        <tr>
          <td class="nowrap">
            <p class="text-bold no-margin">Agenda</p>
          </td>
          <td>
            <% if @next_meetup && @next_meetup.talks.any? %>
              <% @next_meetup.talks.each do |talk| %>
                <p class="margin-bottom-half">
                  <%= talk.title %>
                  <span class="block">
                    &nbsp;-&nbsp;<%= talk.speaker_name %>
                  </span>
                </p>
              <% end %>
            <% else %>
              <p class="margin-bottom-half">Brak informacji o prezentacjach</p>
            <% end %>
          </td>
        </tr>
      </table>

      <% if @next_meetup %>
        <div class="attendance-section">
          <h3 class="margin-top">Kto będzie?</h3>
          <% attendances = @next_meetup.attendances.confirmed %>
          <% if attendances.any? %>
            <div class="attendance-avatars">
              <% attendances.each do |attendance| %>
                <a href="https://github.com/<%= attendance.github_username %>" target="_blank" rel="noopener" class="attendance-avatar" title="<%= attendance.github_username %>">
                  <img src="https://github.com/<%= attendance.github_username %>.png?size=40" alt="<%= attendance.github_username %>" onerror="this.src='https://github.com/identicons/<%= attendance.github_username %>.png'">
                </a>
              <% end %>
            </div>
            <p class="attendance-count"><%= attendances.count %> osób potwierdziło obecność</p>
          <% else %>
            <p class="no-attendees">Bądź pierwszy i zgłoś obecność!</p>
          <% end %>

          <% if authenticated? && current_user.github_username %>
            <% user_attendance = @next_meetup.attendances.find_by(github_username: current_user.github_username) %>
            <% if user_attendance %>
              <div class="your-attendance">
                <p class="attendance-status">Twoja odpowiedź: <span class="status-<%= user_attendance.status_name %>"><%= user_attendance.status_name == 'yes' ? 'Tak, będę!' : 'Może' %></span></p>
                <%= button_to "Zmień", attendances_path(status: user_attendance.status == 1 ? 0 : 1), method: :post, class: "btn btn-secondary btn-sm" %>
              </div>
            <% else %>
              <%= form_with url: attendances_path, method: :post, class: "attendance-form margin-top" do |f| %>
                <%= f.hidden_field :meetup_id, value: @next_meetup.id %>
                <div class="form-group">
                  <label class="text-bold">Czy przyjdziesz?</label>
                  <div class="radio-group">
                    <label class="radio-label">
                      <%= f.radio_button :status, 1, required: true %> Tak, będę!
                    </label>
                    <label class="radio-label">
                      <%= f.radio_button :status, 0 %> Może
                    </label>
                  </div>
                </div>
                <%= f.submit "Zgłoś obecność", class: "btn btn-brand" %>
              <% end %>
            <% end %>
          <% else %>
            <div class="attendance-form margin-top">
              <p class="form-note">Zaloguj się przez GitHub, aby zgłosić obecność:</p>
              <a href="<%= auth_provider_path(:github) %>" class="btn btn-brand">Zaloguj przez GitHub</a>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
    <div class="grid-item one-half compact-one">
      <h2>Lokalizacja</h2>
      <div class="landing-map-canvas">
        <a href="https://www.google.com/maps/place/Hackerspace+Tr%C3%B3jmiasto/@54.3896224,18.5792051,17z/data=!3m1!4b1!4m6!3m5!1s0x46fd754a50efe4c1:0xdbe977101a1abc1e!8m2!3d54.3896193!4d18.58178!16s%2Fg%2F11mv_2z54_?entry=ttu" target="_blank">
          <%= image_tag "mapa.png", alt: "" %>
        </a>
      </div>
    </div>
  </div>
</div>

<div class="container padding-bottom">
  <div class="grid">
    <div class="grid-item one-half compact-one">
      <h2>Poznajmy się!</h2>
      <p>Tworzymy społeczność, która nie tylko dzieli się wiedzą,
        ale jest też otwarta na zawieranie nowych znajomości.
        Spotykamy się podczas integracji w pubach, kawiarniach, kinie, itp.
        Jeśli chcesz wspólnie z nami tworzyć społeczność TRUG
        dołącz do naszej grupy na Slack -
        <a class="link-brand" href="https://3cityIT.slack.com/messages/trug/">3CityIT</a>. Czekamy na Ciebie!
      </p>
      <a class="link-brand landing-link" href="mailto:oskarszrajer@gmail.com?subject=TRUG">Dołącz do grupy</a>
    </div>
    <div class="grid-item one-half compact-one landing-bg-rubies"></div>
  </div>
</div>

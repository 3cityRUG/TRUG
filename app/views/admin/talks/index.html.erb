<%# Talks Index - Restructured for mobile compatibility %>
<header class="page-header">
  <h1 class="page-title">
    Prezentacje
    <span class="badge badge-count"><%= @talks.count %></span>
  </h1>
  <p class="page-subtitle">Wszystkie prezentacje z spotkaÅ„ TRUG</p>
</header>

<section class="section">
  <%# Action Button %>
  <div class="action-grid" style="margin-bottom: var(--space-6);">
    <%= link_to admin_meetups_path, class: "action-card" do %>
      <span class="action-card-icon" aria-hidden="true">â†</span>
      <span class="action-card-label">WrÃ³Ä‡ do spotkaÅ„</span>
    <% end %>
  </div>

  <%# Stats %>
  <% 
    talks_with_video = @talks.select { |t| t.video_id.present? }.count
    talks_with_slides = @talks.select { |t| t.slides_url.present? }.count
    total_meetups = Meetup.count
    avg_talks = total_meetups > 0 ? (@talks.count.to_f / total_meetups).round(1) : 0
  %>

  <div class="stats-grid" style="margin-bottom: var(--space-6);">
    <article class="stat-card">
      <span class="stat-icon" aria-hidden="true">ğŸ¤</span>
      <span class="stat-number"><%= @talks.count %></span>
      <span class="stat-label">Wszystkie</span>
    </article>

    <article class="stat-card">
      <span class="stat-icon" aria-hidden="true">ğŸ¥</span>
      <span class="stat-number" style="color: var(--color-success);"><%= talks_with_video %></span>
      <span class="stat-label">Z wideo</span>
    </article>

    <article class="stat-card">
      <span class="stat-icon" aria-hidden="true">ğŸ“Š</span>
      <span class="stat-number" style="color: var(--color-brand);"><%= talks_with_slides %></span>
      <span class="stat-label">Ze slajdami</span>
    </article>

    <article class="stat-card">
      <span class="stat-icon" aria-hidden="true">ğŸ“ˆ</span>
      <span class="stat-number"><%= avg_talks %></span>
      <span class="stat-label">Åšr. na spotkanie</span>
    </article>
  </div>

  <%# Talks List %>
  <div class="card">
    <div class="card-header">
      <h2 class="card-header-title">
        <span aria-hidden="true">ğŸ¤</span>
        Lista prezentacji
      </h2>
    </div>
    <div class="card-body">
      <% if @talks.any? %>
        <ul class="meetup-list" role="list">
          <% @talks.each do |talk| %>
            <li class="meetup-list-item">
              <div class="meetup-list-info">
                <span class="meetup-list-number" aria-hidden="true">ğŸ¤</span>
                <div class="meetup-list-details">
                  <span class="meetup-list-title"><%= talk.title %></span>
                  <span class="meetup-list-meta">
                    <%= talk.speaker_name %>
                    <span aria-hidden="true">â€¢</span>
                    <%= link_to admin_meetup_path(talk.meetup), class: "meetup-link" do %>
                      <span class="meetup-badge">#<%= talk.meetup.number %></span>
                    <% end %>
                    <span aria-hidden="true">â€¢</span>
                    <time datetime="<%= talk.meetup.date.iso8601 %>"><%= l talk.meetup.date, format: :long %></time>
                  </span>
                </div>
              </div>
              <div class="meetup-list-actions" style="flex-wrap: wrap; gap: var(--space-2);">
                <% if talk.slides_url.present? %>
                  <%= link_to "Slajdy", talk.slides_url, target: "_blank", class: "btn btn-ghost btn-sm" %>
                <% end %>
                <% if talk.source_code_url.present? %>
                  <%= link_to "Kod", talk.source_code_url, target: "_blank", class: "btn btn-ghost btn-sm" %>
                <% end %>
                <% if talk.video_id.present? %>
                  <span class="video-badge <%= talk.video_provider || 'youtube' %>">
                    <%= (talk.video_provider || 'youtube').capitalize %>
                  </span>
                <% end %>
                <%= link_to "Edytuj", edit_admin_meetup_talk_path(talk.meetup, talk), class: "btn btn-secondary btn-sm" %>
                <%= button_to "UsuÅ„", admin_meetup_talk_path(talk.meetup, talk), method: :delete, form: { data: { turbo_confirm: "Czy na pewno chcesz usunÄ…Ä‡ tÄ™ prezentacjÄ™?" } }, class: "btn btn-danger btn-sm" %>
              </div>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="empty-state">
          <div class="empty-state-icon" aria-hidden="true">ğŸ¤</div>
          <h3 class="empty-state-title">Brak prezentacji</h3>
          <p class="empty-state-description">Dodaj prezentacje do spotkaÅ„, aby zobaczyÄ‡ je na tej liÅ›cie.</p>
          <%= link_to "PrzejdÅº do spotkaÅ„", admin_meetups_path, class: "btn btn-brand" %>
        </div>
      <% end %>
    </div>
  </div>
</section>

<header class="page-header">
  <h1 class="page-title">Dashboard</h1>
  <p class="page-subtitle">PrzeglÄ…d aktywnoÅ›ci TRUG</p>
</header>

<% upcoming_count = Meetup.upcoming.count %>
<% avg_talks = @meetups_count > 0 ? (@talks_count.to_f / @meetups_count).round(1) : 0 %>

<section class="section" aria-labelledby="stats-heading">
  <h2 id="stats-heading" class="visually-hidden">Statystyki</h2>
  <div class="stats-grid">
    <article class="stat-card">
      <span class="stat-icon" aria-hidden="true">ğŸ“…</span>
      <span class="stat-number"><%= @meetups_count %></span>
      <span class="stat-label"><%= polish_pluralize(@meetups_count, "Spotkanie", "Spotkania", "SpotkaÅ„") %></span>
    </article>

    <article class="stat-card">
      <span class="stat-icon" aria-hidden="true">ğŸ¤</span>
      <span class="stat-number"><%= @talks_count %></span>
      <span class="stat-label"><%= polish_pluralize(@talks_count, "Prezentacja", "Prezentacje", "Prezentacji") %></span>
    </article>

    <article class="stat-card <%= 'success' if upcoming_count > 0 %>">
      <span class="stat-icon" aria-hidden="true">ğŸš€</span>
      <span class="stat-number">
        <%= upcoming_count %>
        <% if upcoming_count > 0 %>
          <span class="badge badge-success badge-sm">Aktywne</span>
        <% end %>
      </span>
      <span class="stat-label"><%= polish_pluralize(upcoming_count, "NadchodzÄ…ce", "NadchodzÄ…ce", "NadchodzÄ…cych") %></span>
    </article>

    <article class="stat-card">
      <span class="stat-icon" aria-hidden="true">ğŸ“Š</span>
      <span class="stat-number"><%= avg_talks %></span>
      <span class="stat-label">Prezentacji / spotkanie</span>
    </article>
  </div>
</section>

<section class="section" aria-labelledby="actions-heading">
  <div class="card">
    <div class="card-header">
      <h2 id="actions-heading" class="card-header-title">
        <span aria-hidden="true">âš¡</span>
        Szybkie akcje
      </h2>
    </div>
    <div class="card-body">
      <div class="action-grid">
        <%= link_to new_admin_meetup_path, class: "action-card" do %>
          <span class="action-card-icon" aria-hidden="true">ğŸ“…</span>
          <span class="action-card-label">Nowe spotkanie</span>
        <% end %>

        <%= link_to admin_meetups_path, class: "action-card" do %>
          <span class="action-card-icon" aria-hidden="true">ğŸ“‹</span>
          <span class="action-card-label">Wszystkie spotkania</span>
        <% end %>

        <%= link_to admin_talks_path, class: "action-card" do %>
          <span class="action-card-icon" aria-hidden="true">ğŸ¤</span>
          <span class="action-card-label">Wszystkie prezentacje</span>
        <% end %>
      </div>
    </div>
  </div>
</section>

<% if @next_meetup %>
  <section class="section" aria-labelledby="next-meetup-heading">
    <article class="card next-meetup-card">
      <div class="card-header">
        <h2 id="next-meetup-heading" class="card-header-title">
          <span aria-hidden="true">ğŸ¯</span>
          NajbliÅ¼sze spotkanie
        </h2>
        <% if @next_meetup.date >= Date.today %>
          <span class="badge badge-success">NadchodzÄ…ce</span>
        <% else %>
          <span class="badge badge-secondary">ZakoÅ„czone</span>
        <% end %>
      </div>
      <div class="card-body">
        <div class="next-meetup-highlight">
          <span class="next-meetup-number" aria-label="Spotkanie numer <%= @next_meetup.number %>">#<%= @next_meetup.number %></span>
          <div class="next-meetup-details">
            <p class="next-meetup-date">
              <time datetime="<%= @next_meetup.date.iso8601 %>">
                <%= l @next_meetup.date, format: :long %>
              </time>
            </p>
            <p class="next-meetup-talks">
              <%= @next_meetup.talks.size %> <%= polish_pluralize(@next_meetup.talks.size, "prezentacja", "prezentacje", "prezentacji") %>
            </p>
          </div>
        </div>
      </div>
      <div class="card-footer">
        <%= link_to "Edytuj spotkanie", edit_admin_meetup_path(@next_meetup), class: "btn btn-brand btn-small" %>
        <%= link_to "Dodaj prezentacjÄ™", new_admin_meetup_talk_path(@next_meetup), class: "btn btn-ghost btn-small" %>
      </div>
    </article>
  </section>
<% end %>

<section class="section" aria-labelledby="recent-heading">
  <div class="card">
    <div class="card-header">
      <h2 id="recent-heading" class="card-header-title">
        <span aria-hidden="true">ğŸ•</span>
        <%= @recent_meetups.count %> <%= polish_pluralize(@recent_meetups.count, "ostatnie spotkanie", "ostatnie spotkania", "ostatnich spotkaÅ„") %>
      </h2>
      <%= link_to "Zobacz wszystkie", admin_meetups_path, class: "btn btn-ghost btn-small" %>
    </div>
    <div class="card-body">
      <% if @recent_meetups.any? %>
        <ul class="meetup-list" role="list">
          <% @recent_meetups.each do |meetup| %>
            <li class="meetup-list-item">
              <div class="meetup-list-info">
                <span class="meetup-list-number" aria-hidden="true"><%= meetup.number %></span>
                <div class="meetup-list-details">
                  <span class="meetup-list-title">Spotkanie #<%= meetup.number %></span>
                  <span class="meetup-list-meta">
                    <time datetime="<%= meetup.date.iso8601 %>"><%= l meetup.date, format: :long %></time>
                    <span aria-hidden="true">â€¢</span>
                    <span><%= meetup.talks.size %> <%= polish_pluralize(meetup.talks.size, "prezentacja", "prezentacje", "prezentacji") %></span>
                  </span>
                </div>
              </div>
              <div class="meetup-list-actions">
                <%= link_to "SzczegÃ³Å‚y", admin_meetup_path(meetup), class: "btn btn-ghost btn-small" %>
                <%= link_to "Edytuj", edit_admin_meetup_path(meetup), class: "btn btn-brand btn-small" %>
              </div>
            </li>
          <% end %>
        </ul>
      <% elsif @meetups_count == 0 %>
        <div class="empty-state">
          <div class="empty-state-icon" aria-hidden="true">ğŸ“­</div>
          <h3 class="empty-state-title">Brak spotkaÅ„</h3>
          <p class="empty-state-description">
            Nie masz jeszcze Å¼adnych spotkaÅ„. UtwÃ³rz pierwsze spotkanie, aby rozpoczÄ…Ä‡.
          </p>
          <%= link_to "UtwÃ³rz pierwsze spotkanie", new_admin_meetup_path, class: "btn btn-brand" %>
        </div>
      <% else %>
        <div class="empty-state">
          <div class="empty-state-icon" aria-hidden="true">ğŸ“­</div>
          <p class="empty-state-description">Brak wczeÅ›niejszych spotkaÅ„ do wyÅ›wietlenia.</p>
        </div>
      <% end %>
    </div>
  </div>
</section>
